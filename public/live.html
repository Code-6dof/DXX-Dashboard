<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>DXX Tracker — Game Archive</title>
  <link rel="stylesheet" href="css/style.css" />
  <link rel="stylesheet" href="css/live.css" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
</head>
<body>
  <!-- ───── Navigation ───── -->
  <nav class="main-nav">
    <div class="nav-inner">
      <div class="nav-logo">
        <span class="logo-icon">DXX</span>
        <span>DXX Tracker</span>
      </div>
      <div class="nav-links">
        <a href="live.html" class="nav-link active">Archive</a>
        <a href="index.html" class="nav-link">Live Games</a>
      </div>
    </div>
  </nav>

  <!-- ───── Header / Hero ───── -->
  <header class="hero">
    <div class="hero-inner">
      <div class="hero-logo">
        <span class="logo-icon">DXX</span>
        <h1>DXX Dashboard</h1>
      </div>
      <p class="subtitle">Descent Multiplayer — Every Frag, Every Game</p>
      <p class="dataset-info" id="datasetInfo" style="margin: 0.5rem 0; color: var(--text-dim); font-size: 0.9rem;">
        <span id="datasetRange"></span>
      </p>
      <div class="stats-bar" id="statsBar">
        <div class="stat">
          <span id="totalGames" class="stat-num">—</span>
          <small>Total Games</small>
        </div>
        <div class="stat">
          <span id="totalPlayers" class="stat-num">—</span>
          <small>Unique Pilots</small>
        </div>
        <div class="stat">
          <span id="total1v1" class="stat-num accent-red">—</span>
          <small>1v1 Duels</small>
        </div>
        <div class="stat">
          <span id="totalFFA" class="stat-num accent-green">—</span>
          <small>FFA Matches</small>
        </div>
        <div class="stat">
          <span id="totalKills" class="stat-num accent-gold">—</span>
          <small>Total Kills</small>
        </div>
      </div>
    </div>
  </header>

  <!-- ───── Navigation / Mode Tabs ───── -->
  <nav class="tabs" id="modeTabs">
    <button class="tab active" data-mode="all">All Games</button>
    <button class="tab" data-mode="1v1">1v1 Duels</button>
    <button class="tab" data-mode="ffa">Free-For-All</button>
    <button class="tab" data-mode="stats">Leaderboard</button>
  </nav>

  <!-- ───── Filters ───── -->
  <section class="filters" id="filtersSection">
    <input type="text" id="searchInput" placeholder="Search player or map..." autocomplete="off" />
    <select id="yearFilter"><option value="">All Years</option></select>
    <select id="monthFilter"><option value="">All Months</option></select>
    <select id="mapFilter"><option value="">All Maps</option></select>
    <select id="versionFilter">
      <option value="">All Versions</option>
      <option value="D1">Descent 1</option>
      <option value="D2">Descent 2</option>
    </select>
    <button id="applyFilters" class="btn-primary">Apply</button>
    <button id="clearFilters" class="btn-secondary">Clear</button>
  </section>

  <!-- ───── Charts ───── -->
  <section class="charts-section" id="chartsSection">
    <div class="chart-card">
      <h3>Games Over Time (2014-2026)</h3>
      <canvas id="gamesOverTimeChart"></canvas>
    </div>
    <div class="chart-card">
      <h3>Game Mode Distribution</h3>
      <canvas id="modeDistChart"></canvas>
    </div>
    <div class="chart-card wide">
      <h3>Top 30 Players by Total Kills</h3>
      <canvas id="topPlayersChart"></canvas>
    </div>
    <div class="chart-card">
      <h3>Top 20 Most Played Maps</h3>
      <canvas id="topMapsChart"></canvas>
    </div>
  </section>

  <!-- ───── All Games Table View ───── -->
  <section class="view-section" id="allView">
    <h2>All Games</h2>
    <div class="table-wrap">
      <table id="gamesTable">
        <thead>
          <tr>
            <th data-sort="timestamp" class="sortable active-sort">Date ▼</th>
            <th>Map</th>
            <th>Mode</th>
            <th>Version</th>
            <th>Players</th>
            <th>Duration</th>
            <th>Winner</th>
            <th>Link</th>
          </tr>
        </thead>
        <tbody id="gamesBody"></tbody>
      </table>
    </div>
    <div class="pagination" id="pagination"></div>
  </section>

  <!-- ───── 1v1 Duel View ───── -->
  <section class="view-section" id="duelView" style="display:none;">
    <h2>1v1 Duels</h2>
    <p class="view-desc">Head-to-head combat — two pilots, one winner.</p>
    <div class="duel-list" id="duelList"></div>
    <div class="pagination" id="duelPagination"></div>
  </section>

  <!-- ───── FFA View ───── -->
  <section class="view-section" id="ffaView" style="display:none;">
    <h2>Free-For-All Matches</h2>
    <p class="view-desc">Multi-pilot chaos — last one standing takes the glory.</p>
    <div class="ffa-list" id="ffaList"></div>
    <div class="pagination" id="ffaPagination"></div>
  </section>

  <!-- ───── Player Leaderboard View ───── -->
  <section class="view-section" id="statsView" style="display:none;">
    <h2>Player Leaderboard</h2>
    <input type="text" id="playerSearch" placeholder="Search players..." class="player-search" autocomplete="off" />
    <div class="table-wrap">
      <table id="playersTable">
        <thead>
          <tr>
            <th>#</th>
            <th>Player</th>
            <th>Games</th>
            <th>Total Kills</th>
            <th>Total Deaths</th>
            <th>K/D Ratio</th>
            <th>1v1 Games</th>
            <th>FFA Games</th>
            <th>Last Seen</th>
          </tr>
        </thead>
        <tbody id="playersBody"></tbody>
      </table>
    </div>
  </section>

  <!-- ───── Game Detail Modal ───── -->
  <div class="game-detail-modal" id="gameDetailModal">
    <div class="gdm-backdrop"></div>
    <div class="gdm-dialog">
      <div class="gdm-content" id="gameDetailContent"></div>
    </div>
  </div>

  <!-- ───── Loading Overlay ───── -->
  <div class="loading-overlay" id="loadingOverlay">
    <div class="spinner"></div>
    <p id="loadingText">Loading Dashboard...</p>
    <small id="loadingProgress" style="color: var(--text-dim); margin-top: 0.5rem;"></small>
  </div>

  <!-- ───── Footer ───── -->
  <footer>
    <p>Data sourced from <a href="https://retro-tracker.game-server.cc/archive/full.html" target="_blank">Retro Tracker</a> by Arch • Hosting by PuDLeZ • Built with Chart.js</p>
  </footer>

  <script src="js/charts.js"></script>
  <script src="js/filters.js"></script>
  <script src="js/game-detail.js"></script>
  <script src="js/app.js"></script>
</body>
</html>
